extends layout

block content
  .container.page-title-container
    h1.page-title My Profile
    h2= user.name
  .container
    form(action='/profile/update' method='POST')
      .form-group
        label(for='email') Email
        input#email.form-control(type='text' name='email' value=user.email disabled)
      .form-group
        label(for='name') Name
        input#name.form-control(type='text' name='name' value=user.name)
      .form-group
        label(for='phone') Phone
        input#phone.form-control(type='phone' name='phone' value=user.phone)
      button.btn.action-button(type='submit') Update
  hr
  .container 
    h2.subtitle My Children
    if user.children.length > 0
      table.table.table-responsive.wrap-text
        thead
          tr
            th First Name
            th Last Name
            th Birthday
            th Delete
        tbody
          each child, i in user.children
            tr
              td= child.first_name
              td= child.last_name
              td= child.dob
              td
                button.btn.btn-danger(type='button' onclick=`deleteChild('${child.uuid}')`)
                  .trash-icon ðŸ—‘
  .container 
    button#addChildButton.btn.action-button(type='button') Add Child +
    form#addChildForm(action='/profile/add-children' method='POST' style='display: none;')
        .form-group
            //label(for='first_name')
            input#first_name.form-control(type='text' name='first_name' placeholder="First Name" required)
        .form-group
            //label(for='last_name')
            input#last_name.form-control(type='text' name='last_name' placeholder='Last Name' required)
        .form-group
            label(for='dob') Birthday
            input#dob.form-control(type='date' name='dob' value='Birthday' required)
        button.btn.btn-primary(type='submit') Submit
  hr
  .container.member 
    if user.membership
      h2.subtitle My Membership
      ol
        li #{user.membership.type}
        li Covers #{user.membership.num_children} children 
        li Includes #{user.membership.num_visits} visits
        li $#{user.membership.cost} monthly 
        li #{user.membership.discount}% off snacks, birthday bookings, and toys
      p x days until next billling
    
  .container 
    a.btn.action-button.mx-auto(type='button' href='/logout') Logout
  
  script.
    document.getElementById('addChildButton').addEventListener('click', function() {
        var status = document.getElementById('addChildForm').style.display;
        document.getElementById('addChildForm').style.display = status =='block' ? 'none' : 'block';
        this.innerHTML = status =='block' ? 'Add Child +': 'Close';
    });
    function deleteChild(id) {
      fetch(
        `/profile/${id}`, 
        { method: 'DELETE' }
      ).then(() => window.location.reload());
    }

